/*! testnode 2016-03-07 */
angular.module("peopleServices",["ngResource"]).factory("people",["$resource",function(a){return a("GetAgent",{},{list:{method:"GET",isArray:!1},query:{method:"POST",isArray:!1}})}]);var app=angular.module("testApp",["ngRoute","ngAnimate","peopleServices"]);app.config(["$routeProvider",function(a){a.when("/peoples",{templateUrl:"partials/people-list.html",controller:"HelloAngular"}).when("/peoples/:peopleId",{templateUrl:"partials/people-detail.html",controller:"peopleDetailCtrl"}).otherwise({redirectTo:"/peoples"})}]),app.factory("jcache",["$cacheFactory",function(a){return a("jcache")}]),app.filter("FirstCharUpper",function(){return function(a){var b=a.trim().split(" "),c=[];for(var d in b)c.push(b[d][0].toUpperCase()+b[d].substr(1).toLowerCase());return c.join(" ")}}),app.controller("HelloAngular",["$scope","$http","$filter","people","jcache","$route",function(a,b,c,d,e,f){function g(){d.query({type:"Pager",from:1,qty:4},function(b){a.peoples=b.data,a.Total=b.total,e.put("people.list",a.peoples)})}function h(a){for(var b=[],c=1;a>c;c++)b.push(c);return b}a.peoples=e.get("people.list"),a.peoples||g(),a.Refresh=function(){g()},a.orderfield="id",a.pageSize=3,a.pageIndex="0",jQuery(".pn.actived").css({color:"red","font-size":"40px"}),a.BA=h,a.PrevPage=function(){var b=Number.parseInt(a.pageIndex)-1;a.pageIndex=(0>b?0:b).toString()},a.NextPage=function(){var b=Number.parseInt(a.pageIndex)+1,d=Math.ceil(c("filter")(a.peoples,a.query).length/a.pageSize)-1;a.pageIndex=(b>d?d:b).toString(),b>=d&&a.More()},a.GoPage=function(b){a.pageIndex=(b-1).toString()},a.ChangeSize=function(){var b=Math.ceil(c("filter")(a.peoples,a.query).length/a.pageSize);a.pageIndex+1>b&&(a.pageIndex=b-1)},a.More=function(){if(a.query)alert("请先清空筛选条件");else if(a.peoples.length<a.Total){var b=a.peoples.length+1,c=4;d.query({type:"Pager",from:b,qty:c},function(b){a.peoples=a.peoples.concat(b.data),e.put("people.list",a.peoples)})}}}]),app.controller("peopleDetailCtrl",["$scope","$routeParams","people","jcache",function(a,b,c,d){a.p=d.get("people.Id"+b.peopleId),a.p||c.query({type:"Detail",agentid:b.peopleId},function(c){a.p=c.data[0],d.put("people.Id"+b.peopleId,a.p)})}]),app.animation(".pn",function(){return{addClass:function(a,b,c){return"actived"==b?(jQuery(a).css({animation:"zoom-in 0.3s forwards"}),function(b){b&&a.stop()}):void 0},removeClass:function(a,b,c){return"actived"==b?(jQuery(a).css({animation:"zoom-out 0.3s forwards"}),function(b){b&&a.stop()}):void 0}}}),app.run(["$rootScope","$log","$location","$window",function(a,b,c,d){function e(a){b.log("locationChangeStart"),b.log(arguments),""!=c.path()&&"/peoples"!=c.path()}function f(a){b.log("locationChangeSuccess"),b.log(arguments)}function g(a){b.log("routeChangeStart"),b.log(arguments)}function h(a){b.log("routeChangeSuccess"),b.log(arguments)}a.$on("$locationChangeStart",e),a.$on("$locationChangeSuccess",f),a.$on("$routeChangeStart",g),a.$on("$routeChangeSuccess",h)}]);